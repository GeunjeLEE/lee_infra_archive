global
   log /dev/log local0
   log /dev/log local1 notice
   chroot /var/lib/haproxy
    stats timeout 30s
    user haproxy
    group haproxy
    daemon

defaults
     log global
     mode http
     option httplog
     option dontlognull
     timeout connect 5000
     timeout client 50000
     timeout server 50000

frontend http_front
     bind *:80
     stats uri /haproxy?stats
     default_backend http_backend

backend http_backend
     balance roundrobin
     {% for backend in backends -%}
     server nodejs_webapp {{ backend['ip'] }}:8080 check
     {% endfor %}
