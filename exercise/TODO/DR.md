# 재해복구 Disaster Recovery
장비로 인한 장애나 사이버 공격과 같은 인재 또는 재연재해가 발생한 이후
조직이 IT인프라에 대한 액세스와 기능을 복구하는 방법

## 작동 방식
재해 복구는 재해의 영향을 받지 않는 외부 위치에서 데이터 및 컴퓨터 처리 작업을 복제한다.
자연 재해, 장비 고장, 사이버 공격으로 인해 서버가 다운되면 비즈니스는 데이터가 백업된 두 번째 위치에서 손실된 데이터를 복구해야 한다.

## 재해 복구의 유형
- 백업
  - 가장 단순한 유형의 재해 복구
  - 외부 또는 이동식 드라이브에 데이터를 저장하는 방식
  - 최소한의 비지니스 연속성만 지원할 수 있다.
- 콜드 사이트 (RTO: 수주~ 수개월)
  - 재해가 발생한 후, 거의 사용되지 않는 2차 시설에 기본적인 인프라를 구축하여 업무 공간을 마련한다.
    - 재해 발생 시에 데이터를 근간으로 필요한 정보자원을 조달하여 복구하는 방식이다.
  - 비지니스 연속성에는 도움이 되지만, 중요한 데이터를 보호하거나 복구할 수 없다. 다른 복구 방법과 병행해야한다.
  - 즉, 인프라를 구축할 수 있는 공간만을 미리 준비해둔 개념.
- 웜 사이트 (RTO: 수일~ 수주)
  - 주기적으로 시스템 및 데이터 백업 테이프를 로컬이나 원격지에 보관 및 소산하는 방식으로 전통적인 백업 방식이다. 
  - 저비용 구성이 가능하고 대부분의 테이프(TAPE) 및 디스크(DISK) 백업 방식이 여기에 속한다.
    - 중요성이 높은 정보기술자원만 부분적으로 백업 센터에 보유하는 개념이다.
- 핫 사이트 (RTO: 수시간 이내)
  - 주 센터와 백업 센터 간 동일한 시스템을 구축하고, 벡업 센터에 데이터 사본을 항상 최신 상태로 유지한다.
  - 미러 사이트와 거의 동일한 방식이나 백업 센터는 대기 상태로 두어 주 센터 재해 발생 시 백업 센터를 액티브로 전환한다.
  - 즉, 주 센터와 백업 센터를 Active<->standby로 구성하여 서비스한다.
  - 구축에 오랜 시간이 소요되고 콜드 사이트보다 높은 비용이 들지만 다운타임을 줄일 수 있다.
- 미러 사이트 (RTO: 즉시)
  - 주 센터와 백업 센터 간 동일한 시스템 이미지 구성 및 데이터를 구축하여 재해/장애 발생 시에도 영향이 없는 복제 시스템을 구성한다. 
  - 또한 주 센터 및 백업센터간 네트워크 이중화 구성을 통해 신속한 복구가 가능하다. 말단 사용자는 장애 상황을 알 수 가 없다.
  - 즉, 주 센터와 백업 센터를 Active<->Active로 구성하여 서비스한다.
- Disaster Recovery as a Service
  - 재해 또는 랜섬웨어 공격이 발생하는 경우 DRaaS 공급업체는 조직의 컴퓨터 처리 작업을 
      자체 클라우드 인프라로 옮겨 조직의 서버가 다운되더라도 벤더의 위치에서 비즈니스 운영을 중단 없이 지속할 수 있다.
- Back Up as a Service
  - 원격 위치에 데이터를 백업하는 방식과 마찬가지로, BUaaS에서는 외부 공급업체가 조직의 데이터를 백업
  - 인프라를 백업하지 않는다.
- DC 센터 재해복구
  - 데이터 센터의 물리적 요소를 통해 데이터를 보호하고 특정 유형의 재해 발생 시 더 신속한 재해 복구가 가능하다.
  - 백업 전원은 정전 시 비즈니스가 운영을 중단하지 않고 지속할 수 있도록 해준다.
  - 물리적인 재해복구 도구이기 때문에 사이버 공격이 발생하는 경우에는 도움이 되지 않는다.
- 가상화
  - 물리적 재해의 영향을 받지 않는 외부 가상 머신에 특정 운영 및 데이터 또는 전체의 컴퓨팅 환경을 복제하여 백업한다.
  - 가상화를 활용하면 일부 재해 복구 프로세스를 자동화하여 모든 요소를 더 신속하게 복구할 수 있다.
  - 가상화를 효과적인 재해 복구 툴로 활용하려면
    - 데이터와 워크로드를 자주 옮겨야 하며 조직 내에서 몇 대의 가상 머신이 운영되고 있는지 IT 팀과 원활히 소통해야 한다.
- 특정 시점 사본
  - 특정 시점 스냅샷이라고도 하는 특정 시점 사본은 특정 시점의 전체 DB에 대한 사본을 만든다.
  - 이것을 통해 데이터를 복원할 수 있지만, 이는 해당 사본이 재해의 영향을 받지 않는 외부 또는 가상 머신에 저장된 경우에 한한다.
- 즉각적인 복구
  - 특정 시점 사본과 유사하다, DB를 복사하는 대신, 가상 머신의 스냅샷을 생성한다.

# 복제
## 복제 방식
- H/W적 복제 방식
  - 디스크 장치를 이용한 복제
    - 자료가 최종적으로 저장되는 디스크를 복제 대상으로 하여, 사용 중인 원본 디스크를 원거리 지역의 복구용 디스크로 복제하는 방식.
    - 주 센터의 원본 디스크와 백업 센터의 복구용 디스크는 기본적으로 마이크로코드(Microcode 2)(?)수준에서 완벽한 호환성을 제공하여야 하지만,
    - 디스크에 별도의 가상화 솔루션 등을 활용한다면 이기종 디스크 간에도 복제가 가능하다. 
    - 디스크 장치를 이용한 복제방식의 구성 시, 최초에는 디스크 전체를 대상으로 복제 작업을 수행하므로 많은 시간이 소요되나, 
    - 이후 운영 시에는 디스크의 변경분만을 복제하므로, 고속 복제가 가능하다.
- S/W적 복제 방식
  - 운영체제를 이용한 복제 
    - 데이터를 디스크에 저장, 관리하기 위한 논리적인 볼륨을 만들어 사용한다. 
    - 즉, 데이터는 논리적 볼륨에서 관리, 전송되어 이것이 물리적 디스크에 저장되는 것이다. 
    - 운영체제를 이용한 복제 방식은 서버에서 디스크로 데이터를 전송하고 저장하는 중간 단계에서 데이터 블록을 복제하여 백업 센터로 보내는 방식이다. 
    - 따라서 운영체제를 이용한 복제 방식에는 주 센터와 백업 센터의 양쪽 서버에 데이터의 복제를 관리하기 위한 동일한 복제솔루션을 설치하여야 한다. 
    - 복제솔루션은 해당 서버 자체에서 수행되거나, 별도의 디스크 관리 서버 자원을 사용하여 수행될 수 있다. 
    - 그러므로 재해복구시스템 구축 시 기존의 운영환경의 용량 및 부하를 고려하여 서버 자원의 적정성을 검토하여야 한다.
    - 일반적으로 중간 정도의 성능과 용량의 디스크를 사용하거나, 이기종 디스크를 사용하는 운영환경에서 재해복구시스템을 구축하는 경우에 주로 사용된다.
  - DBMS를 이용한 복제
    - 주 센터의 DBMS에서 사용되는 SQL(Structured Query Language)문 혹은 변경 로그를 원격 사이트의 DBMS에 전송하여 복제하는 방식이다. 
    - 주 센터와 백업 센터의 DBMS 및 복제 솔루션이 동일해야 하며, 디스크, 논리적 볼륨 및 플랫폼의 종류가 다르더라도 구현이 가능하다. 
    - 또한, DBMS를 이용한 복제 솔루션은 주 센터와 백업 센터 서버의 자원을 사용하여 동작하므로 서버 자원의 증설을 검토하여야 한다.

## 데이터 전송 방식
데이터 복구 시스템에서는 데이터 복제방식과 더불어 데이터전송 방식을 알맞게 혼합하여 현 시스템과 재해복구 수준에 최적화된 재해복구 시스템을 구축하는 것이 중요하다.<br>
하지만, 주 센터 운영시스템에서의 실수나 오류로 인한 잘못된 데이터의 추가 및 변경도 백업 센터에 동일하게 복제되어<br>
주 센터의 논리적 데이터 오류에 의한 장애시 원격지에서도 동일한장애가 발생하게 된다. <br>
따라서 재해복구시스템만 구축되면 모든 장애와 재해를 막을 수 있는 것은 아니다.<br>

### Sync(동기 복제)
> 주/백업 센터 동시 데이터 변경, 주/백업 센터간 고속 회선 필요, 주 센터의 작업 실수는 백업 센터의 작업실수

- Sync 방식은 어떠한 상황에서도 완벽한 데이터 복구를 보장하여 준다.
- 사용자 혹은 작업이 주 센터의 운영 시스템에서 데이터를 추가 혹은 변경하였을 경우
  - 주 센터와 백업 센터에서도 정상적으로 추가 혹은 변경이 완료되었다는 것을 시스템에서 확인한 후에 사용자 혹은 직업에 추가 혹은 변경 완료 신호를 보내게 되는 방식이다. 
    - 따라서 주 센터와 재해복구센터 간의 데이터 정합성은 항상 유지되므로 가장 안전하고 신뢰성이 높은 방식이다. 
- 그러나 주 센터와 재해복구센터 간을 연결하는 고속의 회선이 필요하다. 
  - 왜냐하면, 주 센터 뿐 아니라 백업 센터에 있는 데이터 역시 빠른 시간 내에 추가, 변경하여야 응답속도의 지연을 막아 기존의 서비스 수준을 유지할 수 있기 때문이다. 
- 주 센터와 재해복구센터 간의 회선 장애 혹은 재해복구시스템의 장애 및 운영 실수는 즉시 주 센터의 운영 시스템에도 영향을 미쳐 서비스 장애로 이어질 수 있다.
  - 따라서 재해복구시스템 유지 관리의 어려움과 운영수준 유지를 위한 인력, 비용이 추가로 발생하게 된다.

### ASync(비동기 복제)
- Async 방식의 가장 큰 특징은 Sync 방식과 달리 재해복구시스템을 구축하여 데이터를 복제하더라도 기존 운영 서비스의 성능에 거의 영향을 주지 않는다는 것이다. 
- 재해복구시스템을 Async 방식으로 구축하면 기존 운영 서비스는 기존과 동일하게 동작하고
  - 데이터 복제는 기존 운영 시스템의 서비스와는 별도로 디스크, 서버 및 DBMS수준의 전송방식에 따라 운영 서비스 이후 독립적으로 동작한다. 
- 즉, 데이터 복제를 수행하기는 하나 그것이 언제 수행되는지는 재해복구를 위한 시스템의 환경 및 여러 조건에 따라 정해진다. 
- 하지만, Sync 방식보다 비해 현 시점에서 운영 시스템의 데이터 복제를 보장하지는 못한다.

# 백업
## 백업 방식
![1](https://user-images.githubusercontent.com/19552819/98464531-e447f000-2206-11eb-9006-b162be0f3e6a.png)

- 전체 백업
  - 선택 된 폴더의 데이터를 모두 백업
  - 항상 모든 데이터를 백업하고 있으므로, 복원이 가장 빠르다.
    - 다른 방식과 비교하여 많은 저장 공간을 차지하고, 백업 시간이 오래 걸린다.

![3](https://user-images.githubusercontent.com/19552819/98464532-e4e08680-2206-11eb-9a72-401548694843.png)

- 증분 백업
  - 선택 된 폴더의 데이터를 전체 백업한 후, 이후로는 변경/추가 된 데이터만 백업
  - 사용되는 저장 공간이 비교적 적고, 백업이 빠르다.
    - 다른 방식교 비교하여 복원 속도가 느리다.
  
![2](https://user-images.githubusercontent.com/19552819/98464533-e5791d00-2206-11eb-9acd-d1ac8f42e3da.png)
  
- 차등 백업
  - 선택 된 폴더의 데이터를 전체 백업한 후, 백업한 시점 이후 변경/추가 되는 데이터를 모두 백업
  - 백업 작업은 전체 백업보다 빠르지만 증분 백업보다 느리다.
    - 복원 작업은 전체 백업보다 느리지만 증분 백업보다 빠릅니다.

